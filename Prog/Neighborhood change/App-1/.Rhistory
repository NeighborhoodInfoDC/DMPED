library(tidyverse)
library(DescTools)
library(purrr)
library(tidycensus) #you might need to install this first and get an API key-easy, just sign up
library(mapview)
library(stringr)
library(educationdata)
library(sf)
library(readxl)
library(urbnthemes)
library(sp)
library(ipumsr)
library(survey)
library(srvyr)
#library(dummies)
library(dplyr)
library(Hmisc)
library(leaflet)
tractboundary_20 <- get_acs(geography = "tract",
variables = c("B01003_001"),
state = "DC",
geometry = TRUE,
year = 2022)
#read in the CSV I sent
neighborhoodchange_masterdata <- read.csv("C:/Users/Ysu/Documents/DMPED/DMPED/Prog/Neighborhood change/App-1/neighborhoodchange_masterdata.csv")
tractboundary_20$GEOID <- as.numeric(tractboundary_20$GEOID)
# master <- neighborhoodchange_masterdata %>%
#   #mutate(GEOID=as.numeric(GEOID)) %>% #you might need to switch the format of GEOID, character vs. numeric for merge
#   left_join(tractboundary_20, by=c("GEOID"))
#yl: https://github.com/tidyverse/ggplot2/issues/3391 above code didn't work, so I use right_join to do the join to keep the sf class.
master<- tractboundary_20 %>%
right_join(neighborhoodchange_masterdata, by=c("GEOID"))
urban_colors7 <- colorFactor(
palette = c("#73bfe2", "#f5cbdf", "#fce39e", "#1696d2", "#e9807d", "#fdd870", "#dcedd9"),
domain = master$neighborhood.category
)
# Create the leaflet map
m <- leaflet(master) %>%
addProviderTiles(providers$Stadia.StamenTonerLite) %>%
addPolygons(
fillColor = ~urban_colors7(neighborhood.category),
weight = 1,
opacity = 1,
color = "white",
dashArray = "3",
fillOpacity = 0.8,
highlightOptions = highlightOptions(
weight = 5,
color = "#666",
dashArray = "",
fillOpacity = 0.7,
bringToFront = TRUE
),
label = ~sprintf(
"Census Tract: %s<br>Ward: %s<br>Neighborhood: %s<br>Type: %s",
GEOID, Ward, NBH_NAMES, neighborhood.category
) %>% lapply(htmltools::HTML),
labelOptions = labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "15px",
direction = "auto"
)
) %>%
addLegend(
pal = urban_colors7,
values = ~neighborhood.category,
opacity = 0.7,
title = "Neighborhood Type",
position = "bottomright"
)
# Display the map
m
m <- leaflet(master) %>%
addProviderTiles(providers$Stadia.StamenTonerLite) %>%
addPolygons(
fillColor = ~urban_colors7(neighborhoodtype),
weight = 1,
opacity = 1,
color = "white",
dashArray = "3",
fillOpacity = 0.8,
highlightOptions = highlightOptions(
weight = 5,
color = "#666",
dashArray = "",
fillOpacity = 0.7,
bringToFront = TRUE
),
label = ~sprintf(
"Census Tract: %s<br>Neighborhood: %s<br>Type: %s",
GEOID, NBH_NAMES, neighborhoodtype
) %>% lapply(htmltools::HTML),
labelOptions = labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "15px",
direction = "auto"
)
) %>%
addLegend(
pal = urban_colors7,
values = ~neighborhoodtype,
opacity = 0.7,
title = "Neighborhood Type",
position = "bottomright"
)
# Display the map
m
install.packages("installr")
library(installr)
updateR()
m <- leaflet(master) %>%
addProviderTiles(providers$Stadia.StamenTonerLite) %>%
addPolygons(
fillColor = ~urban_colors7(neighborhood.category),
weight = 1,
opacity = 1,
color = "white",
dashArray = "3",
fillOpacity = 0.8,
highlightOptions = highlightOptions(
weight = 5,
color = "#666",
dashArray = "",
fillOpacity = 0.7,
bringToFront = TRUE
),
label = ~sprintf(
"Census Tract: %s<br>Ward: %s<br>Neighborhood: %s<br>Type: %s",
GEOID, Ward, NBH_NAMES, neighborhood.category
) %>% lapply(htmltools::HTML),
labelOptions = labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "15px",
direction = "auto"
)
) %>%
addLegend(
pal = urban_colors7,
values = ~neighborhood.category,
opacity = 0.7,
title = "Neighborhood Type",
position = "bottomright"
)
# Display the map
m
m <- leaflet(master) %>%
addProviderTiles(providers$Stadia.StamenTonerLite) %>%
addPolygons(
fillColor = ~urban_colors7(neighborhood.category),
weight = 1,
opacity = 1,
color = "white",
dashArray = "3",
fillOpacity = 0.8,
highlightOptions = highlightOptions(
weight = 5,
color = "#666",
dashArray = "",
fillOpacity = 0.7,
bringToFront = TRUE
),
label = ~sprintf(
"Census Tract: %s<br>Ward: %s<br>Neighborhood: %s<br>Type: %s",
GEOID, Ward, NBH_NAMES, neighborhood.category
) %>% lapply(htmltools::HTML),
labelOptions = labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "15px",
direction = "auto"
)
) %>%
addLegend(
pal = urban_colors7,
values = ~neighborhood.category,
opacity = 0.7,
title = "Neighborhood Type",
position = "bottomright"
)
# Display the map
m
updateR()
